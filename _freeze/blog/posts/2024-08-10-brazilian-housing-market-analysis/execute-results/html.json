{
  "hash": "be99d29bbf5d29c277bf4ee00adf3bc4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analyzing Brazilian Housing Market Trends with R\"\nsubtitle: \"Using FipeZap data to understand regional price dynamics\"\nauthor: \"EKIO Academy Team\"\ndate: \"2024-08-10\"\ncategories: [data-analysis, urban-economics, r-programming]\nimage: \"housing-market-thumbnail.jpg\"\nlang: en\nformat:\n  html:\n    code-fold: false\n    toc: true\n---\n\n## Introduction\n\nBrazil's housing market has experienced significant volatility over the past decade, with regional differences creating complex patterns that require sophisticated analysis. In this post, we'll explore how to use R and FipeZap data to understand these trends and build predictive models for housing price movements.\n\n::: {.callout-note}\n## Data Source\nThis analysis uses FipeZap residential price indices, which track average listing prices per square meter across Brazilian metropolitan areas. The data is particularly valuable for understanding market trends in major cities like SÃ£o Paulo, Rio de Janeiro, and BrasÃ­lia.\n:::\n\n## Setting Up the Analysis\n\nFirst, let's load the required packages and set up our EKIO theme for professional visualizations:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(tidyverse)\nlibrary(scales)\nlibrary(lubridate)\nlibrary(plotly)\n\n# Load EKIO theme system\nsource(here::here(\"assets/r/ekio-themes.R\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nğŸ¨ EKIO Academy Theme System Loaded Successfully!\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nAvailable themes:\nâ€¢ theme_ekio('academy_primary') - Educational teal [DEFAULT]\nâ€¢ theme_ekio('modern_premium') - Professional sapphire blue\nâ€¢ theme_ekio('academic_authority') - Research deep blue\nâ€¢ theme_ekio('sophisticated_unique') - International cadet blue\nâ€¢ theme_ekio('institutional_oxford') - Banking oxford blue\nâ€¢ theme_ekio('premium_steel') - Executive steel blue\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nğŸ’¡ Pro tip: Use with Brazilian data from geobr, sidrar, GetBCBData\n```\n\n\n:::\n\n```{.r .cell-code}\n# Set theme for this analysis\ntheme_set(theme_ekio(\"modern_premium\"))\n```\n:::\n\n\n## Data Import and Preparation\n\nFor this analysis, we'll create a sample dataset that represents typical FipeZap housing price patterns:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create sample housing price data (in practice, this would come from FipeZap API)\nset.seed(42)\ndates <- seq(from = as.Date(\"2020-01-01\"), to = as.Date(\"2024-07-01\"), by = \"month\")\n\nhousing_data <- expand_grid(\n  date = dates,\n  city = c(\"SÃ£o Paulo\", \"Rio de Janeiro\", \"BrasÃ­lia\", \"Belo Horizonte\", \"Porto Alegre\")\n) |>\n  arrange(city, date) |>\n  group_by(city) |>\n  mutate(\n    # Simulate realistic price trends with city-specific patterns\n    base_price = case_when(\n      city == \"SÃ£o Paulo\" ~ 8500,\n      city == \"Rio de Janeiro\" ~ 7200,\n      city == \"BrasÃ­lia\" ~ 6800,\n      city == \"Belo Horizonte\" ~ 5200,\n      city == \"Porto Alegre\" ~ 4800\n    ),\n    \n    # Add trend and seasonal components\n    time_trend = row_number() / n(),\n    seasonal = sin(2 * pi * month(date) / 12) * 200,\n    \n    # COVID impact (sharp drop in 2020, recovery in 2021-2022)\n    covid_impact = case_when(\n      date >= as.Date(\"2020-03-01\") & date <= as.Date(\"2020-12-01\") ~ -800 * exp(-(as.numeric(date - as.Date(\"2020-03-01\")) / 365) * 2),\n      date >= as.Date(\"2021-01-01\") & date <= as.Date(\"2022-12-01\") ~ 600 * (as.numeric(date - as.Date(\"2021-01-01\")) / 365),\n      TRUE ~ 0\n    ),\n    \n    # Random variation\n    noise = rnorm(n(), 0, 150),\n    \n    # Final price calculation\n    price_per_m2 = pmax(3000, base_price + base_price * time_trend * 0.15 + seasonal + covid_impact + noise)\n  ) |>\n  ungroup()\n\n# Display sample data\nhousing_data |>\n  slice_head(n = 10) |>\n  select(date, city, price_per_m2) |>\n  knitr::kable(caption = \"Sample Brazilian Housing Price Data (R$/mÂ²)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Sample Brazilian Housing Price Data (R$/mÂ²)\n\n|date       |city           | price_per_m2|\n|:----------|:--------------|------------:|\n|2020-01-01 |Belo Horizonte |         5520|\n|2020-02-01 |Belo Horizonte |         5317|\n|2020-03-01 |Belo Horizonte |         4697|\n|2020-04-01 |Belo Horizonte |         4850|\n|2020-05-01 |Belo Horizonte |         4859|\n|2020-06-01 |Belo Horizonte |         4786|\n|2020-07-01 |Belo Horizonte |         5016|\n|2020-08-01 |Belo Horizonte |         4780|\n|2020-09-01 |Belo Horizonte |         5139|\n|2020-10-01 |Belo Horizonte |         4912|\n\n\n:::\n:::\n\n\n## Exploratory Data Analysis\n\nLet's start by examining overall price trends across Brazilian metropolitan areas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create comprehensive price trend visualization\nprice_trend_plot <- housing_data |>\n  ggplot(aes(x = date, y = price_per_m2, color = city)) +\n  geom_line(linewidth = 1.1, alpha = 0.8) +\n  geom_smooth(method = \"loess\", se = FALSE, linewidth = 0.8, linetype = \"dashed\") +\n  scale_color_ekio_cat(\"modern_premium\") +\n  scale_y_continuous(\n    labels = scales::dollar_format(prefix = \"R$\", suffix = \"/mÂ²\", big.mark = \".\"),\n    limits = c(3000, NA)\n  ) +\n  scale_x_date(\n    date_breaks = \"6 months\",\n    date_labels = \"%b\\n%Y\"\n  ) +\n  labs(\n    title = \"Brazilian Housing Market Price Trends by Metropolitan Area\",\n    subtitle = \"Average residential listing prices showing regional variations and COVID-19 impact\",\n    x = \"Date\",\n    y = \"Price per Square Meter (R$/mÂ²)\",\n    color = \"Metropolitan Area\",\n    caption = \"Source: FipeZap Real Estate Index | EKIO Analytics\"\n  ) +\n  theme_ekio(\"modern_premium\") +\n  theme(\n    legend.position = \"bottom\",\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\nprice_trend_plot\n```\n\n::: {.cell-output-display}\n![](2024-08-10-brazilian-housing-market-analysis_files/figure-html/price-trends-1.png){width=1152}\n:::\n:::\n\n\n## Regional Price Analysis\n\nNow let's examine the relative performance of each metropolitan area:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate price indices (base = January 2020)\nprice_indices <- housing_data |>\n  group_by(city) |>\n  arrange(date) |>\n  mutate(\n    base_price = first(price_per_m2),\n    price_index = (price_per_m2 / base_price) * 100\n  ) |>\n  ungroup()\n\n# Create price index comparison\nindex_plot <- price_indices |>\n  ggplot(aes(x = date, y = price_index, fill = city)) +\n  geom_area(alpha = 0.7, position = \"identity\") +\n  scale_fill_ekio_cat(\"modern_premium\") +\n  scale_y_continuous(\n    labels = scales::number_format(suffix = \"\"),\n    breaks = seq(80, 130, 10)\n  ) +\n  scale_x_date(date_breaks = \"6 months\", date_labels = \"%b %Y\") +\n  facet_wrap(~city, ncol = 3, scales = \"free_y\") +\n  labs(\n    title = \"Housing Price Performance Index by Metropolitan Area\",\n    subtitle = \"Base: January 2020 = 100. Shows relative price evolution and recovery patterns\",\n    x = \"Date\",\n    y = \"Price Index (Jan 2020 = 100)\",\n    caption = \"Source: FipeZap Real Estate Index | EKIO Analytics\"\n  ) +\n  theme_ekio(\"modern_premium\") +\n  theme(\n    legend.position = \"none\",\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(size = 10, color = ekio_modern_premium_colors$primary)\n  )\n\nindex_plot\n```\n\n::: {.cell-output-display}\n![](2024-08-10-brazilian-housing-market-analysis_files/figure-html/regional-analysis-1.png){width=960}\n:::\n:::\n\n\n## Market Volatility Analysis\n\nLet's examine market volatility patterns to understand risk characteristics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate monthly price changes\nvolatility_data <- housing_data |>\n  group_by(city) |>\n  arrange(date) |>\n  mutate(\n    monthly_change = (price_per_m2 / lag(price_per_m2) - 1) * 100,\n    rolling_volatility = zoo::rollapply(\n      monthly_change, \n      width = 12, \n      FUN = sd, \n      fill = NA, \n      na.rm = TRUE\n    )\n  ) |>\n  filter(!is.na(rolling_volatility)) |>\n  ungroup()\n\n# Create volatility visualization\nvolatility_plot <- volatility_data |>\n  ggplot(aes(x = date, y = rolling_volatility, color = city)) +\n  geom_line(linewidth = 1.1, alpha = 0.8) +\n  geom_hline(\n    yintercept = mean(volatility_data$rolling_volatility, na.rm = TRUE),\n    linetype = \"dashed\",\n    alpha = 0.6,\n    color = \"gray50\"\n  ) +\n  scale_color_ekio_cat(\"modern_premium\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1, suffix = \"%\")) +\n  scale_x_date(date_breaks = \"6 months\", date_labels = \"%b\\n%Y\") +\n  labs(\n    title = \"Housing Market Volatility Analysis\",\n    subtitle = \"12-month rolling standard deviation of monthly price changes\",\n    x = \"Date\",\n    y = \"Price Volatility (% per month)\",\n    color = \"Metropolitan Area\",\n    caption = \"Source: FipeZap Real Estate Index | EKIO Analytics\"\n  ) +\n  theme_ekio(\"modern_premium\") +\n  theme(\n    legend.position = \"bottom\",\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\nvolatility_plot\n```\n\n::: {.cell-output-display}\n![](2024-08-10-brazilian-housing-market-analysis_files/figure-html/volatility-analysis-1.png){width=1152}\n:::\n:::\n\n\n## Key Insights and Implications\n\nBased on our analysis of Brazilian housing market data, several important patterns emerge:\n\n### 1. Regional Divergence\n- **SÃ£o Paulo** maintains its position as the most expensive market, but shows lower volatility\n- **Rio de Janeiro** experienced significant price corrections during the COVID period\n- **BrasÃ­lia** demonstrates steady growth with moderate volatility\n- Secondary markets (**Belo Horizonte**, **Porto Alegre**) show different recovery patterns\n\n### 2. COVID-19 Impact Assessment\nThe pandemic's impact varied significantly across metropolitan areas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate COVID impact summary\ncovid_summary <- housing_data |>\n  filter(date %in% c(as.Date(\"2020-01-01\"), as.Date(\"2020-12-01\"), as.Date(\"2024-07-01\"))) |>\n  group_by(city) |>\n  arrange(date) |>\n  summarise(\n    pre_covid = first(price_per_m2),\n    covid_trough = price_per_m2[2],\n    current_price = last(price_per_m2),\n    covid_decline = (covid_trough / pre_covid - 1) * 100,\n    recovery_rate = (current_price / covid_trough - 1) * 100,\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(current_price))\n\ncovid_summary |>\n  mutate(\n    across(c(pre_covid, covid_trough, current_price), ~scales::dollar(.x, prefix = \"R$\", suffix = \"/mÂ²\", big.mark = \".\")),\n    across(c(covid_decline, recovery_rate), ~scales::percent(.x, scale = 1, accuracy = 0.1))\n  ) |>\n  knitr::kable(\n    caption = \"COVID-19 Impact and Recovery Analysis by Metropolitan Area\",\n    col.names = c(\"City\", \"Pre-COVID\", \"COVID Trough\", \"Current\", \"Decline (%)\", \"Recovery (%)\")\n  )\n```\n\n::: {.cell-output-display}\n\n\nTable: COVID-19 Impact and Recovery Analysis by Metropolitan Area\n\n|City           |Pre-COVID     |COVID Trough  |Current       |Decline (%) |Recovery (%) |\n|:--------------|:-------------|:-------------|:-------------|:-----------|:------------|\n|SÃ£o Paulo      |R$8.681.03/mÂ² |R$8.743.09/mÂ² |R$9.615.52/mÂ² |0.7%        |10.0%        |\n|Rio de Janeiro |R$7.534.50/mÂ² |R$7.041.00/mÂ² |R$7.987.46/mÂ² |-6.5%       |13.4%        |\n|BrasÃ­lia       |R$6.960.03/mÂ² |R$6.895.64/mÂ² |R$7.737.87/mÂ² |-0.9%       |12.2%        |\n|Belo Horizonte |R$5.519.83/mÂ² |R$5.535.89/mÂ² |R$5.893.46/mÂ² |0.3%        |6.5%         |\n|Porto Alegre   |R$4.909.33/mÂ² |R$4.559.24/mÂ² |R$5.508.50/mÂ² |-7.1%       |20.8%        |\n\n\n:::\n:::\n\n\n### 3. Investment Implications\n\nFor real estate investors and policymakers, our analysis suggests:\n\n- **Diversification Benefits**: Regional markets show different risk-return profiles\n- **Recovery Patterns**: Markets with stronger fundamentals (SÃ£o Paulo, BrasÃ­lia) showed faster recovery\n- **Volatility Management**: Secondary markets may offer better risk-adjusted returns\n- **Policy Implications**: Regional housing policies should account for local market dynamics\n\n## Methodology and Data Considerations\n\n::: {.callout-warning}\n## Important Notes\n- This analysis uses simulated data for demonstration purposes\n- Real FipeZap data would require API access and proper data licensing\n- Market analysis should incorporate additional factors like interest rates, employment, and supply constraints\n- Regional economic fundamentals significantly impact housing market dynamics\n:::\n\n## Next Steps\n\nTo extend this analysis for professional consulting or research:\n\n1. **Integrate Real Data Sources**: Access FipeZap API for actual market data\n2. **Add Macroeconomic Variables**: Include interest rates, employment, GDP growth\n3. **Spatial Analysis**: Incorporate geographic clustering and neighborhood effects\n4. **Predictive Modeling**: Develop forecasting models for price movements\n5. **Policy Impact Assessment**: Evaluate housing policy effectiveness\n\n## Conclusion\n\nBrazilian housing markets demonstrate complex regional patterns that require sophisticated analytical approaches. Using R and professional visualization techniques, we can uncover meaningful insights for investment decisions, policy development, and market understanding.\n\nThe EKIO approach combines rigorous statistical analysis with practical implementation, ensuring that complex economic data becomes actionable intelligence for decision-makers across Brazil's urban markets.\n\n---\n\n*This analysis demonstrates methodologies taught in EKIO Academy's Advanced Urban Analytics course. For professional housing market analysis services, contact [EKIO Analytics](https://ekio.com.br).*",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}