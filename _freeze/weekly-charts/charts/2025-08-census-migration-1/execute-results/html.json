{
  "hash": "8971bc5078c383b6e6795fda049a186a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"São Paulo's Car Ownership Divide\"\ndescription: \"Wealthy neighborhoods own 4x more cars per household than peripheral areas, while the historic center mirrors low-income patterns\"\ndate: \"2025-08-01\"\nimage: \"/assets/images/weekly-charts/sp-car-ownership-map.svg\"\ncategories: [\"transportation\", \"urban-economics\", \"sao-paulo\"]\nformat:\n  html:\n    page-layout: article\n    toc: false\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(readxl)\nlibrary(ragg)\nlibrary(ekioplot)\n\nimport::from(forcats, fct_reorder)\nimport::from(sidrar, get_sidra)\nimport::from(readxl, read_excel)\nimport::from(here, here)\nimport::from(sf, st_drop_geometry)\n\ngeo_state <- geobr::read_state()\ndim_state <- as_tibble(st_drop_geometry(geo_state))\n\ntab_state <- get_sidra(617, variable = 289, geo = \"State\")\n\ncenso <- read_excel(\n  here(\"static\", \"data\", \"weekly-charts\", \"censo_migracao.xlsx\"),\n  skip = 5,\n  col_names = FALSE,\n  na = \"-\"\n)\n\ncol_names <- c(\n  \"code_muni\",\n  \"municipio\",\n  \"uf_de_nascimento\",\n  \"2000\",\n  \"2010\",\n  \"2022\"\n)\n\nnames(censo) <- col_names\n\ncenso <- censo |>\n  fill(code_muni) |>\n  fill(municipio) |>\n  mutate(\n    abbrev_state = str_extract(municipio, \"(?<=\\\\()[A-Z]{2}\"),\n    name_muni = str_remove(municipio, \" \\\\([A-Z]{2}\\\\)$\")\n  ) |>\n  select(\n    code_muni,\n    name_muni,\n    abbrev_state,\n    uf_de_nascimento,\n    `2000`,\n    `2010`,\n    `2022`\n  )\n\ncenso <- censo |>\n  pivot_longer(\n    cols = starts_with(\"20\"),\n    names_to = \"year\",\n    values_to = \"pop\"\n  ) |>\n  mutate(across(c(code_muni, year, pop), as.numeric))\n\n# gauchos fora do RS\ngauchos <- censo |>\n  filter(\n    uf_de_nascimento == \"Rio Grande do Sul\",\n    abbrev_state != \"RS\",\n    year == 2022\n  )\n\npop_muni <- censo |>\n  filter(year == 2022) |>\n  summarise(pop_muni = sum(pop, na.rm = TRUE), .by = \"code_muni\")\n\ngauchos <- gauchos |>\n  left_join(pop_muni, by = \"code_muni\") |>\n  mutate(share_pop = pop / pop_muni * 100)\n\nlibrary(ekioplot)\n\ndat <- gauchos |>\n  slice_max(pop, n = 15) |>\n  mutate(\n    name_muni = factor(name_muni),\n    name_muni = fct_reorder(name_muni, pop),\n    col_label = str_glue(\"{name_muni} ({abbrev_state})\")\n  )\n\n\nggplot(dat, aes(x = name_muni, y = pop)) +\n  geom_col(fill = ekio_palette()[9], width = 0.8) +\n  geom_hline(yintercept = 0, lwd = 0.8) +\n  geom_text(\n    aes(label = scales::number(pop, accuracy = 1, big.mark = \".\")),\n    family = \"Lato\",\n    size = 3,\n    hjust = 0,\n    nudge_y = 1000\n  ) +\n  geom_text(\n    aes(y = 1000, label = col_label),\n    family = \"Lato\",\n    size = 3,\n    color = \"white\",\n    hjust = 0\n  ) +\n  scale_y_continuous(\n    labels = scales::label_number(big.mark = \".\"),\n    expand = expansion(c(0, 0.1))\n  ) +\n  labs(\n    title = \"Catarinense com Sotaque Gaudério\",\n    subtitle = \"Cidades com maior número de gaúchos emigrados* (Censo, 2022)\",\n    x = NULL,\n    y = NULL,\n    caption = \"Fonte: IBGE (Censo 2022) | EKIO\\n(*) Pessoas que moram na cidade, mas que nasceram no Rio Grande do Sul\"\n  ) +\n  coord_flip() +\n  theme_ekio(base_family = \"Lato\") +\n  theme(\n    panel.grid.major.y = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.y = element_blank(),\n    plot.title = element_text(color = \"#000000\")\n  )\n```\n\n::: {.cell-output-display}\n![](2025-08-census-migration-1_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}