---
title: "New R Packages for Brazilian Economic Data in 2024"
subtitle: "Latest tools for accessing IBGE, BCB, and IPEA databases"
author: "EKIO Academy Team"
date: "2024-08-05"
categories: [r-programming, brazilian-data]
image: "r-packages-thumbnail.jpg"
lang: en
format:
  html:
    code-fold: false
    toc: true
---

## Introduction

The Brazilian R ecosystem continues to evolve rapidly, with new packages and improvements to existing tools making economic data analysis more accessible than ever. In this post, we'll explore the latest developments in R packages specifically designed for Brazilian economic data, focusing on updates that enhance productivity for economists, researchers, and policy analysts.

::: {.callout-tip}
## Why Brazilian-Specific Packages Matter
Brazilian economic data sources (IBGE, BCB, IPEA) have unique structures, APIs, and metadata systems. Specialized R packages handle these complexities, allowing analysts to focus on insights rather than data wrangling.
:::

## Recent Package Updates and New Releases

### 1. Enhanced `geobr` Package (Version 1.8.0)

The `geobr` package received significant updates in 2024, improving performance and adding new geographic datasets:

```{r geobr-demo}
#| eval: false
#| message: false

# Install latest version
install.packages("geobr")

library(geobr)
library(ggplot2)

# New: Indigenous territories data
indigenous <- read_indigenous_land(year = 2022)

# Improved performance for municipal data
municipalities <- read_municipality(year = 2022, showProgress = TRUE)

# New: Health regions
health_regions <- read_health_region(year = 2022)
```

**Key improvements:**
- **50% faster loading** for large geographic datasets
- **New datasets**: Indigenous territories, health regions, judicial districts
- **Better memory management** for large-scale spatial analysis
- **Enhanced documentation** with practical examples

### 2. `sidrar` Package Enhancements

The `sidrar` package, essential for accessing IBGE's SIDRA system, received important updates:

```{r sidrar-example}
#| eval: false

library(sidrar)

# Enhanced search functionality
available_tables <- search_sidra("PIB municipal", limit = 10)

# Improved data retrieval with better error handling
gdp_data <- get_sidra(
  api = "/t/5938/n6/all/v/37/p/2022/c830/0",
  format = 3,  # More format options available
  header = TRUE
)

# New: Bulk download capabilities
multiple_tables <- bulk_sidra(
  table_codes = c("5938", "6579", "5457"),
  year = 2022,
  format = "wide"
)
```

**New features:**
- **Bulk download support** for multiple tables
- **Better error messages** with suggested corrections
- **Caching system** to reduce API calls
- **Enhanced metadata retrieval** for better documentation

### 3. `GetBCBData` Evolution

The Banco Central data package continues to improve:

```{r bcb-data}
#| eval: false

library(GetBCBData)

# Enhanced time series search
available_series <- search_series("IPCA", source = "BCB")

# Improved data retrieval with validation
inflation_data <- gbcbd_get_series(
  id = 433,  # IPCA-15
  first.date = "2020-01-01",
  last.date = Sys.Date(),
  format.data = "wide",
  do.parallel = TRUE  # New: parallel processing
)

# New: Real-time data alerts
setup_data_alerts(
  series_id = 433,
  email = "analyst@company.com",
  frequency = "monthly"
)
```

### 4. New Package: `ipeaData` (2024 Release)

A brand new package specifically for IPEA databases launched in early 2024:

```{r ipea-data}
#| eval: false

# Brand new package for IPEA data
install.packages("ipeaData")

library(ipeaData)

# Access IPEADATA series
regional_development <- get_ipeadata(
  series_code = "IBGE12_PIBPCMUN12",
  start_date = "2010-01-01",
  end_date = "2022-12-31"
)

# Search functionality
search_ipeadata("produtividade", category = "regional")

# New: Integration with other packages
library(dplyr)
library(geobr)

# Combine IPEA data with geographic boundaries
municipalities <- read_municipality(year = 2022)
gdp_spatial <- municipalities %>%
  left_join(regional_development, by = "code_muni")
```

**Key features:**
- **Direct API integration** with IPEADATA
- **Automatic data cleaning** and standardization
- **Built-in visualization functions** using ggplot2
- **Integration with `geobr`** for spatial analysis

## Practical Applications

Let's see how these improved packages work together for a complete analysis workflow:

```{r workflow-example}
#| eval: false

# Load required packages
library(tidyverse)
library(geobr)
library(sidrar)
library(GetBCBData)
library(scales)

# Set EKIO theme
source("../../assets/r/ekio-themes.R")
theme_set(theme_ekio("modern_premium"))

# 1. Get municipal GDP data from SIDRA
municipal_gdp <- get_sidra(
  api = "/t/5938/n6/all/v/37/p/2021/c830/0"
) %>%
  janitor::clean_names() %>%
  filter(nivel_territorial == "Município") %>%
  mutate(
    gdp_millions = as.numeric(valor) / 1000,  # Convert to millions
    code_muni = as.numeric(substr(codigo_municipio, 1, 6))
  ) %>%
  select(code_muni, municipality = municipio, gdp_millions)

# 2. Get national inflation context from BCB
inflation_context <- gbcbd_get_series(
  id = 433,  # IPCA-15
  first.date = "2021-01-01",
  last.date = "2021-12-31"
) %>%
  summarise(annual_inflation = ((last(value) / first(value)) - 1) * 100)

# 3. Get geographic boundaries
state_boundaries <- read_state(year = 2021, showProgress = FALSE)
muni_boundaries <- read_municipality(
  year = 2021, 
  showProgress = FALSE
) %>%
  filter(abbrev_state %in% c("SP", "RJ", "MG"))  # Focus on Southeast

# 4. Combine and visualize
southeast_analysis <- muni_boundaries %>%
  left_join(municipal_gdp, by = "code_muni") %>%
  filter(!is.na(gdp_millions)) %>%
  mutate(
    gdp_category = case_when(
      gdp_millions >= 10000 ~ "Large (>10B)",
      gdp_millions >= 1000 ~ "Medium (1-10B)",
      gdp_millions >= 100 ~ "Small (100M-1B)",
      TRUE ~ "Micro (<100M)"
    )
  )

# Create professional visualization
southeast_map <- ggplot(southeast_analysis) +
  geom_sf(aes(fill = log10(gdp_millions)), color = "white", size = 0.1) +
  scale_fill_ekio_seq("modern_premium", name = "GDP (log10)") +
  labs(
    title = "Municipal GDP Distribution in Southeast Brazil",
    subtitle = paste0("2021 data with inflation context: ", 
                     round(inflation_context$annual_inflation, 1), "% annual IPCA"),
    caption = "Sources: IBGE (SIDRA), BCB | EKIO Analytics"
  ) +
  theme_ekio("modern_premium") +
  theme(
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )
```

## Package Installation and Management

For analysts working with Brazilian data, here's a recommended package setup:

```{r package-setup}
#| eval: false

# Essential Brazilian data packages
brazilian_packages <- c(
  "geobr",          # Geographic boundaries
  "sidrar",         # IBGE SIDRA data
  "GetBCBData",     # Banco Central data
  "ipeaData",       # IPEA databases
  "rbcb",           # Alternative BCB access
  "electionsBR",    # Electoral data
  "congressbr"      # Congressional data
)

# Install missing packages
new_packages <- brazilian_packages[!(brazilian_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)

# Load all packages
lapply(brazilian_packages, library, character.only = TRUE)

# Verify installations
cat("Installed Brazilian data packages:\n")
for(pkg in brazilian_packages) {
  version <- packageVersion(pkg)
  cat(paste("•", pkg, "version", version, "\n"))
}
```

## Performance and Best Practices

### Data Caching Strategy

```{r caching-strategy}
#| eval: false

# Set up data caching for large datasets
library(here)

# Create cache directory
cache_dir <- here("data", "cache")
if(!dir.exists(cache_dir)) dir.create(cache_dir, recursive = TRUE)

# Cached data retrieval function
get_cached_data <- function(data_name, fetch_function, cache_hours = 24) {
  cache_file <- file.path(cache_dir, paste0(data_name, ".rds"))
  
  # Check if cache exists and is recent
  if(file.exists(cache_file)) {
    cache_time <- file.mtime(cache_file)
    if(difftime(Sys.time(), cache_time, units = "hours") < cache_hours) {
      message("Loading cached data: ", data_name)
      return(readRDS(cache_file))
    }
  }
  
  # Fetch fresh data
  message("Fetching fresh data: ", data_name)
  data <- fetch_function()
  saveRDS(data, cache_file)
  return(data)
}

# Example usage
municipal_data <- get_cached_data(
  "municipal_gdp_2021",
  function() get_sidra(api = "/t/5938/n6/all/v/37/p/2021/c830/0"),
  cache_hours = 168  # Cache for 1 week
)
```

## Looking Ahead: 2024 Developments

Several exciting developments are expected in the Brazilian R ecosystem:

### Upcoming Features

1. **Enhanced `geobr` Integration**: Direct links with IBGE statistical data
2. **`tidycensus` Brazilian Equivalent**: Streamlined demographic data access
3. **Real-time Data Streaming**: Live economic indicators via WebSocket APIs
4. **Machine Learning Integration**: Pre-built models for Brazilian economic forecasting

### Community Contributions

The Brazilian R community continues to grow:

- **R-Ladies São Paulo** organizing monthly data science meetups
- **Brazilian R Consortium** supporting package development
- **IBGE Data Science Labs** collaborating on official packages
- **Academic partnerships** with USP, UFRJ, and other institutions

## Conclusion

The Brazilian R ecosystem in 2024 offers unprecedented access to national economic data, combining ease of use with powerful analytical capabilities. These package improvements enable more economists and analysts to work with official Brazilian data sources, democratizing access to high-quality economic analysis.

### Key Takeaways

1. **Package Updates**: Significant performance improvements across the ecosystem
2. **New Tools**: `ipeaData` package expands analytical possibilities
3. **Better Integration**: Packages now work seamlessly together
4. **Professional Workflows**: Enhanced caching and error handling
5. **Community Growth**: Strong ecosystem development continues

For economists and data scientists working with Brazilian data, 2024 represents a significant leap forward in analytical capabilities. These tools, combined with proper methodology and domain expertise, enable world-class economic analysis and policy research.

---

*Stay updated with the latest Brazilian R package developments through EKIO Academy's blog. For advanced training on these tools, explore our [Brazilian Data Mastery course](../../courses/brazilian-data-mastery/index.qmd).*